(window.webpackJsonp=window.webpackJsonp||[]).push([[453],{1555:function(e,t,a){"use strict";a.r(t);var o=a(0),s=a(1),c=a(9),n=a(92),i=a(25),r=a(112),l=a(8),d=a(116),u=a(203),b=a(109),m=a(378),p=a(229),j=a(228),g=a(61),O=a.n(g),v=a(376),f=(a(32),a(10)),_=a.n(f),h=a(35),M=a(19),y=a(130),C=a(74),k=a(119),x=a(134),w=a(13),I=a(21),N=a(34),T=a(536),D=a(2),S=a(6),R=a(45);class z extends s.PureComponent{renderItem(e,t,a){const{animate:s}=this.props;let c=50,n=100,i="auto",r="auto",l="auto",d="auto";1===t&&(c=100),(4===t||3===t&&a>0)&&(n=50),2===t?0===a?d="1px":r="1px":3===t?(0===a?d="1px":a>0&&(r="1px"),1===a?l="1px":a>1&&(i="1px")):4===t&&(0!==a&&2!==a||(d="1px"),1!==a&&3!==a||(r="1px"),a<2?l="1px":i="1px");const u={left:r,top:i,right:d,bottom:l,width:"".concat(c,"%"),height:"".concat(n,"%")};return Object(o.a)("div",{style:u},e.get("id"),Object(o.a)(R.a,{account:e,animate:s}))}render(){const{accounts:e,size:t}=this.props;return Object(o.a)("div",{className:"account__avatar-composite",style:{width:"".concat(t,"px"),height:"".concat(t,"px")}},void 0,e.take(4).map(((t,a)=>this.renderItem(t,Math.min(e.size,4),a))),e.size>4&&Object(o.a)("span",{className:"account__avatar-composite__label"},void 0,"+",e.size-4))}}Object(D.a)(z,"defaultProps",{animate:S.a});var A=a(26),K=a(78),L=a(184),P=a(186),q=a(41);const E=Object(c.d)({more:{id:"status.more",defaultMessage:"More"},open:{id:"conversation.open",defaultMessage:"View conversation"},reply:{id:"status.reply",defaultMessage:"Reply"},markAsRead:{id:"conversation.mark_as_read",defaultMessage:"Mark as read"},delete:{id:"conversation.delete",defaultMessage:"Delete conversation"},muteConversation:{id:"status.mute_conversation",defaultMessage:"Mute conversation"},unmuteConversation:{id:"status.unmute_conversation",defaultMessage:"Unmute conversation"},replyConfirm:{id:"confirmations.reply.confirm",defaultMessage:"Reply"},replyMessage:{id:"confirmations.reply.message",defaultMessage:"Replying now will overwrite the message you are currently composing. Are you sure you want to proceed?"}}),H=Object(y.a)((e=>e.get("accounts")),((e,t)=>t),((e,t)=>t.map((t=>e.get(t))))),U=Object(q.i)(),V=e=>{let{conversation:t,scrollKey:a,onMoveUp:c,onMoveDown:r}=e;const d=t.get("id"),u=t.get("unread"),m=t.get("last_status"),p=t.get("accounts"),j=Object(n.a)(),g=Object(l.useDispatch)(),O=Object(h.g)(),v=Object(l.useSelector)((e=>U(e,{id:m}))),f=Object(l.useSelector)((e=>H(e,p))),y=Object(s.useCallback)((e=>{let{currentTarget:t}=e;if(S.a)return;const a=t.querySelectorAll(".custom-emoji");for(var o=0;o<a.length;o++){let e=a[o];e.src=e.getAttribute("data-original")}}),[]),D=Object(s.useCallback)((e=>{let{currentTarget:t}=e;if(S.a)return;const a=t.querySelectorAll(".custom-emoji");for(var o=0;o<a.length;o++){let e=a[o];e.src=e.getAttribute("data-static")}}),[]),R=Object(s.useCallback)((()=>{u&&g(Object(b.k)(d)),O.push("/@".concat(v.getIn(["account","acct"]),"/").concat(v.get("id")))}),[g,O,u,d,v]),q=Object(s.useCallback)((()=>{g(Object(b.k)(d))}),[g,d]),V=Object(s.useCallback)((()=>{g(((e,t)=>{0!==t().getIn(["compose","text"]).trim().length?g(Object(I.b)({modalType:"CONFIRM",modalProps:{message:j.formatMessage(E.replyMessage),confirm:j.formatMessage(E.replyConfirm),onConfirm:()=>g(Object(w.ub)(v,O))}})):g(Object(w.ub)(v,O))}))}),[g,v,O,j]),J=Object(s.useCallback)((()=>{g(Object(b.i)(d))}),[g,d]),W=Object(s.useCallback)((()=>{c(d)}),[d,c]),F=Object(s.useCallback)((()=>{r(d)}),[d,r]),Y=Object(s.useCallback)((()=>{v.get("muted")?g(Object(N.u)(v.get("id"))):g(Object(N.p)(v.get("id")))}),[g,v]),B=Object(s.useCallback)((()=>{v.get("hidden")?g(Object(N.q)(v.get("id"))):g(Object(N.o)(v.get("id")))}),[g,v]);if(!v)return null;const G=[{text:j.formatMessage(E.open),action:R},null,{text:j.formatMessage(v.get("muted")?E.unmuteConversation:E.muteConversation),action:Y}];u&&(G.push({text:j.formatMessage(E.markAsRead),action:q}),G.push(null)),G.push({text:j.formatMessage(E.delete),action:J});const Q=f.map((e=>Object(o.a)(M.a,{to:"/@".concat(e.get("acct")),title:e.get("acct")},e.get("id"),Object(o.a)("bdi",{},void 0,Object(o.a)("strong",{className:"display-name__html",dangerouslySetInnerHTML:{__html:e.get("display_name_html")}}))))).reduce(((e,t)=>[e,", ",t])),X={reply:V,open:R,moveUp:W,moveDown:F,toggleHidden:B};return Object(o.a)(C.HotKeys,{handlers:X},void 0,Object(o.a)("div",{className:_()("conversation focusable muted",{"conversation--unread":u}),tabIndex:0},void 0,Object(o.a)("div",{className:"conversation__avatar",onClick:R,role:"presentation"},void 0,Object(o.a)(z,{accounts:f,size:48})),Object(o.a)("div",{className:"conversation__content"},void 0,Object(o.a)("div",{className:"conversation__content__info"},void 0,Object(o.a)("div",{className:"conversation__content__relative-time"},void 0,u&&Object(o.a)("span",{className:"conversation__unread"})," ",Object(o.a)(K.a,{timestamp:v.get("created_at")})),Object(o.a)("div",{className:"conversation__content__names",onMouseEnter:y,onMouseLeave:D},void 0,Object(o.a)(i.a,{id:"conversation.with",defaultMessage:"With {names}",values:{names:Object(o.a)("span",{},void 0,Q)}}))),Object(o.a)(L.a,{status:v,onClick:R,expanded:!v.get("hidden"),onExpandedToggle:B,collapsible:!0}),v.get("media_attachments").size>0&&Object(o.a)(T.a,{compact:!0,media:v.get("media_attachments")}),Object(o.a)("div",{className:"status__action-bar"},void 0,Object(o.a)(A.a,{className:"status__action-bar-button",title:j.formatMessage(E.reply),icon:"reply",iconComponent:x.a,onClick:V}),Object(o.a)("div",{className:"status__action-bar-dropdown"},void 0,Object(o.a)(P.a,{scrollKey:a,status:v,items:G,icon:"ellipsis-h",iconComponent:k.a,size:18,direction:"right",title:j.formatMessage(E.more)}))))))};var J=a(5);const W=(e,t,a)=>{const o=e.querySelector("article:nth-of-type(".concat(t+1,") .focusable"));o&&(a&&e.scrollTop>o.offsetTop?o.scrollIntoView(!0):!a&&e.scrollTop+e.clientHeight<o.offsetTop+o.offsetHeight&&o.scrollIntoView(!1),o.focus())},F=e=>{var t;let{scrollKey:a,...c}=e;const n=Object(s.useRef)(),i=Object(l.useSelector)((e=>e.getIn(["conversations","items"]))),r=Object(l.useSelector)((e=>e.getIn(["conversations","isLoading"],!0))),d=Object(l.useSelector)((e=>e.getIn(["conversations","hasMore"],!1))),u=Object(l.useDispatch)(),m=null===(t=i.last())||void 0===t?void 0:t.get("last_status"),p=Object(s.useCallback)((e=>{const t=i.findIndex((t=>t.get("id")===e))-1;W(n.current.node,t,!0)}),[n,i]),j=Object(s.useCallback)((e=>{const t=i.findIndex((t=>t.get("id")===e))+1;W(n.current.node,t,!1)}),[n,i]),g=Object(s.useMemo)((()=>O()((e=>{u(Object(b.j)({maxId:e}))}),300,{leading:!0})),[u]),f=Object(s.useCallback)((()=>{m&&g(m)}),[g,m]);return Object(J.jsx)(v.a,{...c,scrollKey:a,isLoading:r,showLoading:r&&i.isEmpty(),hasMore:d,onLoadMore:f,ref:n,children:i.map((e=>Object(o.a)(V,{conversation:e,onMoveUp:p,onMoveDown:j,scrollKey:a},e.get("id"))))})},Y=Object(c.d)({title:{id:"column.direct",defaultMessage:"Private mentions"}});t.default=e=>{let{columnId:t,multiColumn:a}=e;const c=Object(s.useRef)(),g=Object(n.a)(),O=Object(l.useDispatch)(),v=!!t,f=Object(s.useCallback)((()=>{O(t?Object(u.h)(t):Object(u.e)("DIRECT",{}))}),[O,t]),_=Object(s.useCallback)((e=>{O(Object(u.g)(t,e))}),[O,t]),h=Object(s.useCallback)((()=>{c.current.scrollTop()}),[c]);return Object(s.useEffect)((()=>{O(Object(b.l)()),O(Object(b.j)());const e=O(Object(m.b)());return()=>{O(Object(b.m)()),e()}}),[O]),Object(J.jsxs)(p.a,{bindToDocument:!a,ref:c,label:g.formatMessage(Y.title),children:[Object(o.a)(j.a,{icon:"at",iconComponent:d.a,title:g.formatMessage(Y.title),onPin:f,onMove:_,onClick:h,pinned:v,multiColumn:a}),Object(o.a)(F,{trackScroll:!v,scrollKey:"direct_timeline-".concat(t),emptyMessage:Object(o.a)(i.a,{id:"empty_column.direct",defaultMessage:"You don't have any private mentions yet. When you send or receive one, it will show up here."}),bindToDocument:!a,prepend:Object(o.a)("div",{className:"follow_requests-unlocked_explanation"},void 0,Object(o.a)("span",{},void 0,Object(o.a)(i.a,{id:"compose_form.encryption_warning",defaultMessage:"Posts on Mastodon are not end-to-end encrypted. Do not share any dangerous information over Mastodon."})," ",Object(o.a)("a",{href:"/terms",target:"_blank"},void 0,Object(o.a)(i.a,{id:"compose_form.direct_message_warning_learn_more",defaultMessage:"Learn more"})))),alwaysPrepend:!0}),Object(o.a)(r.a,{},void 0,Object(o.a)("title",{},void 0,g.formatMessage(Y.title)),Object(o.a)("meta",{name:"robots",content:"noindex"}))]})}}}]);
//# sourceMappingURL=direct_timeline-890d5e936882faa3b1a3.chunk.js.map