(window.webpackJsonp=window.webpackJsonp||[]).push([[447],{1556:function(e,t,a){"use strict";a.r(t);var s,i=a(0),o=a(2),n=(a(17),a(3)),c=a.n(n),l=a(25),d=a(20),r=a.n(d),h=a(23),p=a(8),u=a(15),g=a(21),b=a(1388),m=a(385),O=a(169),v=a(386),j=a(148),y=a(232),f=a(41),_=a(24),I=a(1396),M=a(1381),w=a(10),L=a.n(w),x=a(1);function T(){return T=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},T.apply(this,arguments)}var P,k=function(e){let{title:t,titleId:a,...i}=e;return x.createElement("svg",T({xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 -960 960 960",width:24,"aria-labelledby":a},i),t?x.createElement("title",{id:a},t):null,s||(s=x.createElement("path",{d:"M400-120q-66 0-113-47t-47-113q0-66 47-113t113-47q23 0 42.5 5.5T480-418v-422h240v160H560v400q0 66-47 113t-113 47Z"})))};function E(){return E=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},E.apply(this,arguments)}var N=function(e){let{title:t,titleId:a,...s}=e;return x.createElement("svg",E({xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 -960 960 960",width:24,"aria-labelledby":a},s),t?x.createElement("title",{id:a},t):null,P||(P=x.createElement("path",{d:"M320-200v-560l440 280-440 280Zm80-280Zm0 134 210-134-210-134v268Z"})))},q=a(174),R=a(97),S=a(14),A=a(6);class B extends h.a{constructor(){super(...arguments),Object(o.a)(this,"state",{visible:"hide_all"!==A.h&&!this.props.attachment.getIn(["status","sensitive"])||"show_all"===A.h,loaded:!1}),Object(o.a)(this,"handleImageLoad",(()=>{this.setState({loaded:!0})})),Object(o.a)(this,"handleMouseEnter",(e=>{this.hoverToPlay()&&e.target.play()})),Object(o.a)(this,"handleMouseLeave",(e=>{this.hoverToPlay()&&(e.target.pause(),e.target.currentTime=0)})),Object(o.a)(this,"handleClick",(e=>{0!==e.button||e.ctrlKey||e.metaKey||(e.preventDefault(),this.state.visible?this.props.onOpenMedia(this.props.attachment):this.setState({visible:!0}))}))}hoverToPlay(){return!A.a&&-1!==["gifv","video"].indexOf(this.props.attachment.get("type"))}render(){const{attachment:e,displayWidth:t}=this.props,{visible:a,loaded:s}=this.state,o="".concat(Math.floor((t-4)/3)-4,"px"),n=o,c=e.get("status"),l=c.get("spoiler_text")||e.get("description");let d,r,h,p;if(a){if(["audio","video"].includes(e.get("type")))p=Object(i.a)("img",{src:e.get("preview_url")||c.getIn(["account","avatar_static"]),alt:e.get("description"),lang:c.get("language"),onLoad:this.handleImageLoad}),r="audio"===e.get("type")?Object(i.a)(S.a,{id:"music",icon:k}):Object(i.a)(S.a,{id:"play",icon:N});else if("image"===e.get("type")){const t=100*((e.getIn(["meta","focus","x"])||0)/2+.5),a=100*((e.getIn(["meta","focus","y"])||0)/-2+.5);p=Object(i.a)("img",{src:e.get("preview_url"),alt:e.get("description"),lang:c.get("language"),style:{objectPosition:"".concat(t,"% ").concat(a,"%")},onLoad:this.handleImageLoad})}else"gifv"===e.get("type")&&(p=Object(i.a)("video",{className:"media-gallery__item-gifv-thumbnail","aria-label":e.get("description"),title:e.get("description"),lang:c.get("language"),role:"application",src:e.get("url"),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,autoPlay:A.a,playsInline:!0,loop:!0,muted:!0}),r="GIF");d=Object(i.a)("div",{className:"media-gallery__gifv"},void 0,p,r&&Object(i.a)("div",{className:"media-gallery__item__badges"},void 0,Object(i.a)("span",{className:"media-gallery__gifv__label"},void 0,r)))}else h=Object(i.a)("span",{className:"account-gallery__item__icons"},void 0,Object(i.a)(S.a,{id:"eye-slash",icon:q.a}));return Object(i.a)("div",{className:"account-gallery__item",style:{width:o,height:n}},void 0,Object(i.a)("a",{className:"media-gallery__item-thumbnail",href:"/@".concat(c.getIn(["account","acct"]),"/").concat(c.get("id")),onClick:this.handleClick,title:l,target:"_blank",rel:"noopener noreferrer"},void 0,Object(i.a)(R.a,{hash:e.get("blurhash"),className:L()("media-gallery__preview",{"media-gallery__preview--hidden":a&&s}),dummy:!A.E}),a?d:h))}}Object(o.a)(B,"propTypes",{attachment:r.a.map.isRequired,displayWidth:c.a.number.isRequired,onOpenMedia:c.a.func.isRequired});var C=a(5);class D extends h.a{constructor(){super(...arguments),Object(o.a)(this,"handleLoadMore",(()=>{this.props.onLoadMore(this.props.maxId)}))}render(){return Object(i.a)(m.a,{disabled:this.props.disabled,onClick:this.handleLoadMore})}}Object(o.a)(D,"propTypes",{maxId:c.a.string,onLoadMore:c.a.func.isRequired});class W extends h.a{constructor(){super(...arguments),Object(o.a)(this,"state",{width:323}),Object(o.a)(this,"handleScrollToBottom",(()=>{this.props.hasMore&&this.handleLoadMore(this.props.attachments.size>0?this.props.attachments.last().getIn(["status","id"]):void 0)})),Object(o.a)(this,"handleScroll",(e=>{const{scrollTop:t,scrollHeight:a,clientHeight:s}=e.target;150>a-t-s&&!this.props.isLoading&&this.handleScrollToBottom()})),Object(o.a)(this,"handleLoadMore",(e=>{this.props.dispatch(Object(_.t)(this.props.accountId,{maxId:e}))})),Object(o.a)(this,"handleLoadOlder",(e=>{e.preventDefault(),this.handleScrollToBottom()})),Object(o.a)(this,"handleOpenMedia",(e=>{const{dispatch:t}=this.props,a=e.getIn(["status","id"]),s=e.getIn(["status","language"]);if("video"===e.get("type"))t(Object(g.b)({modalType:"VIDEO",modalProps:{media:e,statusId:a,lang:s,options:{autoPlay:!0}}}));else if("audio"===e.get("type"))t(Object(g.b)({modalType:"AUDIO",modalProps:{media:e,statusId:a,lang:s,options:{autoPlay:!0}}}));else{const i=e.getIn(["status","media_attachments"]),o=i.findIndex((t=>t.get("id")===e.get("id")));t(Object(g.b)({modalType:"MEDIA",modalProps:{media:i,index:o,statusId:a,lang:s}}))}})),Object(o.a)(this,"handleRef",(e=>{e&&this.setState({width:e.offsetWidth})}))}_load(){const{accountId:e,isAccount:t,dispatch:a}=this.props;t||a(Object(u.A)(e)),a(Object(_.t)(e))}componentDidMount(){const{params:{acct:e},accountId:t,dispatch:a}=this.props;t?this._load():a(Object(u.G)(e))}componentDidUpdate(e){const{params:{acct:t},accountId:a,dispatch:s}=this.props;e.accountId!==a&&a?this._load():e.params.acct!==t&&s(Object(u.G)(t))}render(){const{attachments:e,isLoading:t,hasMore:a,isAccount:s,multiColumn:o,blockedBy:n,suspended:c}=this.props,{width:d}=this.state;if(!s)return Object(i.a)(j.a,{multiColumn:o,errorType:"routing"});if(!e&&t)return Object(i.a)(M.a,{},void 0,Object(i.a)(O.a,{}));let r,h=null;return!a||t&&0===e.size||(h=Object(i.a)(m.a,{visible:!t,onClick:this.handleLoadOlder})),c?r=Object(i.a)(l.a,{id:"empty_column.account_suspended",defaultMessage:"Account suspended"}):n&&(r=Object(i.a)(l.a,{id:"empty_column.account_unavailable",defaultMessage:"Profile unavailable"})),Object(i.a)(M.a,{},void 0,Object(i.a)(b.a,{}),Object(i.a)(v.a,{scrollKey:"account_gallery"},void 0,Object(i.a)("div",{className:"scrollable scrollable--flex",onScroll:this.handleScroll},void 0,Object(i.a)(I.a,{accountId:this.props.accountId}),c||n?Object(i.a)("div",{className:"empty-column-indicator"},void 0,r):Object(C.jsxs)("div",{role:"feed",className:"account-gallery__container",ref:this.handleRef,children:[e.map(((t,a)=>null===t?Object(i.a)(D,{maxId:a>0?e.getIn(a-1,"id"):null,onLoadMore:this.handleLoadMore},"more:"+e.getIn(a+1,"id")):Object(i.a)(B,{attachment:t,displayWidth:d,onOpenMedia:this.handleOpenMedia},t.get("id")))),h]}),t&&0===e.size&&Object(i.a)("div",{className:"scrollable__append"},void 0,Object(i.a)(O.a,{})))))}}Object(o.a)(W,"propTypes",{params:c.a.shape({acct:c.a.string,id:c.a.string}).isRequired,accountId:c.a.string,dispatch:c.a.func.isRequired,attachments:r.a.list.isRequired,isLoading:c.a.bool,hasMore:c.a.bool,isAccount:c.a.bool,blockedBy:c.a.bool,suspended:c.a.bool,multiColumn:c.a.bool});t.default=Object(p.connect)(((e,t)=>{let{params:{acct:a,id:s}}=t;const i=s||e.getIn(["accounts_map",Object(y.b)(a)]);return i?{accountId:i,isAccount:!!e.getIn(["accounts",i]),attachments:Object(f.a)(e,i),isLoading:e.getIn(["timelines","account:".concat(i,":media"),"isLoading"]),hasMore:e.getIn(["timelines","account:".concat(i,":media"),"hasMore"]),suspended:e.getIn(["accounts",i,"suspended"],!1),blockedBy:e.getIn(["relationships",i,"blocked_by"],!1)}:{isLoading:!0}}))(W)}}]);
//# sourceMappingURL=account_gallery-b06251fe913970ea7142.chunk.js.map